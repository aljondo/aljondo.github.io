<!doctype html>
<html>
  <head>
  	<title> Mark Turner Soundboard </title>
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css">
  	<script src="https://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.5.0/d3.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/immutable/3.8.2/immutable.min.js"></script>
  </head>
  <body>
    <div id="wrapper">
    </div>
  	<!--<div class='container'>
  		<div class='row'>
  			<div class='col'>
  				<p>test</p>
  			</div>
  			<div class='col'>
  				<p>test</p>
  			</div>
  			<div class='col'>
  				<p>test</p>
  			</div>
  		</div>
  		<div class='row'>
  			<div class='col'>
  				<p>test</p>
  			</div>
  			<div class='col'>
  				<p>test</p>
  			</div>
  			<div class='col'>
  				<p>test</p>
  			</div>
  		</div>
  		<div class='row'>
  			<div class='col'>
  				<p>test</p>
  			</div>
  			<div class='col'>
  				<p>test</p>
  			</div>
  			<div class='col'>
  				<p>test</p>
  			</div>
  		</div>-->
  	<script>
  		var soundDict = getSounds();  
      const categories = [
        'Cries for help',
        'Accusations',
        'Directives',
        'Yelps',
        'Screeches',
      ];
 
      //add all sounds to array to start
      var soundIds = [];
      for(s in soundDict) {
        soundIds.push(s);
      }

      render();

      function createPanel(sound, id) {
        var panel = createDiv('sound-panel', id)

        /*d3.select("#" + id)
          .append('svg')
          .attr("fill", "red")
          .attr("height", 100)
          .attr("width", 100)
          .text(sound.get('name'))*/
        return panel;
      }

      //creates panels for 
      function render() {
        var elem = document.querySelector('#container');
        if(elem) {
          elem.parentNode.removeChild(elem);
        }
        var container = createDiv('', 'container');
        var row;
        for(s in soundIds) {
          if(s % 4 === 0) {
            var row = createDiv('row');
          }
          var sId = soundIds[s];
          var panel = createPanel(soundDict[sId], sId)
          row.append(panel)
          if(s % 4 === 3) {
            container.append(row);
          }
        }
        document.getElementById('wrapper').append(container);

        for(s in soundIds) {
          var sound = soundDict[soundIds[s]];
          d3.select("#" + soundIds[s])
            .append('svg')
            .append('rect')
            .attr("fill", "#CD5C5C")
            .attr("height", 150)
            .attr("width", 150)
            .text(sound.get('name'))
            .on('click', function(d) {
              console.log(sound.get('url'))
              var url = sound.get('url').trim().replace(/ /g,"%20");
              console.log(url)
              var clip = new Audio(url);
              clip.play();
            })
        }
      }

      function getSounds() {
        //hard coding for now
        return {
          DAD: Immutable.Map({
            url: '/marks/DAD!',
            category: 'Yelps',
            name: 'DAD!'
          }),
          damageboostme: Immutable.Map({
            url: '/marks/Damage boost me',
            category: 'Directives',
            name: 'Damage boost me'
          }),
          getthebastion: Immutable.Map({
            url: '/marks/get the bastion',
            category: 'Directives',
            name: 'Get the bastion!'
          }),
          hanzo: Immutable.Map({
            url: '/marks/HANZO',
            category: 'Yelps',
            name: 'HANZO'
          }),
          hello: Immutable.Map({
            url: '/marks/HELLO',
            category: 'Yelps',
            name: 'HELLO'
          }),
          itsfuckingmercy: Immutable.Map({
            url: '/marks/Its fucking mercy',
            category: 'Accusations',
            name: "It's fucking mercy"
          }),
          killoverwatch: Immutable.Map({
            url: '/marks/Kill overwatch',
            category: 'Directives',
            name: 'Kill overwatch'
          }),
          killthatbastion: Immutable.Map({
            url: '/marks/KILL THAT BASTION',
            category: 'Directives',
            name: 'KILL THAT BASTION'
          }),
          noifell: Immutable.Map({
            url: '/marks/NO I FELL IN THE HOLE',
            category: 'Yelps',
            name: 'NO I FELL IN THE HOLE'
          }),
          nooooo: Immutable.Map({
            url: '/marks/NOOOOO',
            category: 'Cries for help',
            name: 'NOOOOO'
          }),
          ononoooo: Immutable.Map({
            url: '/marks/O NO. NOOO',
            category: 'Cries for help',
            name: 'O NO. NOOO'
          }),
          omg: Immutable.Map({
            url: '/marks/OMG',
            category: 'Yelps',
            name: 'OMG'
          }),
          ooohhhh: Immutable.Map({
            url: '/marks/OOOHHHH',
            category: 'Yelps',
            name: 'OOOHHHH'
          }),
          ryan: Immutable.Map({
            url: '/marks/RYAN took the last charge',
            category: 'Accusations',
            name: 'YOU TOOK THE LAST CHARGE'
          }),
          screech2: Immutable.Map({
            url: '/marks/SCREECH 2',
            category: 'Screeches',
            name: 'SCREECH 2'
          }),
          screech: Immutable.Map({
            url: '/marks/SCREECH',
            category: 'Screeches',
            name: 'SCREECH'
          }),
          what: Immutable.Map({
            url: '/marks/WHAT',
            category: 'Yelps',
            name: 'WHAT'
          }),
          whydyoupullhim: Immutable.Map({
            url: "/marks/Why'd you pull him, Ryan",
            category: 'Accusations',
            name: "Why'd you pull him!"
          }),
          winstonsboosted: Immutable.Map({
            url: '/marks/winstons boosted and running after me',
            category: 'Cries for help',
            name: 'winstons boosted and running after me'
          }),
          woohoo: Immutable.Map({
            url: '/marks/Woohoo',
            category: 'Woohoo',
            name: 'woohoo'
          }),
          youtookmyhero: Immutable.Map({
            url: '/marks/You took my hero',
            category: 'Accusations',
            name: 'You took my hero'
          }),
        }
      }

      function createDiv(className, id) {
        var div = document.createElement('div');
        if(className) {
          div.className = className;
        }
        if(id) {
          div.id = id;
        }
        return div;
      }


  	</script>
  </body>
 </html>



